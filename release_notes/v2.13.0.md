# WhisperDoc Technical Release Notes - v2.13.0
**Version Range: v1.14.0 to v2.13.0**

This milestone release introduces comprehensive enterprise-grade security hardening, transitioning the application to a Zero-Trust architecture with robust identity management and hardware-bound encryption.

## Security & Identity Engineering

### OIDC and PKCE Authentication
- Implemented RFC 7636 compliant Proof Key for Code Exchange (PKCE) flow, utilizing the native system browser for secure authentication on Windows.
- Developed a "Dual-Door" authentication architecture supporting both stateless JWT validation (OIDC) and modular static API key verification.
- Integrated JWKS (JSON Web Key Set) auto-discovery with a thread-safe, TTL-based caching layer for public keys to eliminate authentication latency.
- Enforced strict JWT claims validation, including audience (`aud`), issuer (`iss`), and expiration (`exp`), while pinning cryptographic algorithms to RS256 to prevent algorithm substitution attacks.

### Secure Vault and Hardware-Bound Encryption
- Created the SecureVaultService, utilizing Windows Credential Manager and PBKDF2 key derivation (100,000 iterations) seeded by the Windows Machine ID.
- Implemented AES-256 field-level encryption for all transcription data persisted to the local Isar database using AES-CBC mode.
- Developed a robust test suite to verify hardware-bound key derivation, ensuring unique machine IDs generate distinct, non-portable encryption keys.
- Integrated a "Sticky Authorization" pattern that maintains authorized session states across intentional reconnections and incognito mode transitions.

### Transport Security Hardening
- Implemented RFC 1918 validation logic within the TransportSecurityService to strictly block unencrypted WebSocket (WS) connections on public IPs while permitting them for private network development.
- Automated protocol translation (HTTPS to WSS, HTTP to WS) with intelligent canonical path appending for backend endpoints.
- Developed a regex-based `BanStateService` that parses backend-specific 1008 close codes to extract ban durations and provide real-time countdown feeds to the UI.
- Enforced algorithm pinning and constant-time digest verification for static keys to mitigate side-channel timing attacks.

## Protocol & Architectural Improvements

### Handshake State Machine (HSM)
- Developed a "Handshake Cage" protocol that mandates a valid JSON 'hello' event as the primary message, blocking all binary audio processing until identity is verified.
- Implemented a bi-directional "Lock-Step" handshake to ensure perfect synchronization between client and server before data transmission begins.
- Added an intelligent audio buffer that queues binary data during the authentication phase and flushes it immediately upon successful handshake confirmation.
- Introduced a 15-second mandatory handshake timeout to prevent resource exhaustion from "Ghost Connections."

### Active Defense & Zero-Trust
- Migrated from "Lazy" logging to an Active Defense model where protocol violations (e.g., sending audio before auth) trigger immediate socket termination.
- Integrated IP-based connection flood protection with automated banning mechanisms on the backend.
- Ensured a "Close-before-Clear" termination ritual to prevent zombie sockets and ensure session metadata hygiene.
- Implemented a strictly disabled state for recording controls if the current session is not authenticated or if transport security requirements are not met.

## UI & User Experience

### Identity Hub & Status Indicators
- Created the ProfileHub widget, a glassmorphic identity management interface for viewing session metadata and managing sign-out flows.
- Refactored the ActionBar into a functional 5-button layout with a central dynamic connection lock icon.
- Implemented multi-state security indicators:
    - **Green**: Secure TLS 1.3 / WSS connection.
    - **Amber**: Unencrypted local/private network connection.
    - **Red**: Disconnected or blocked/banned state with real-time countdown overlays.
- Optimized the desktop layout by replacing global scrolling with a fixed column structure, utilizing internal scrolling for the transcription area to prevent UI jitter.
